<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>A Plot Recipe for Yao.jl</title>

  
  <meta name="description" content="A distribution plot for Yao.jl">
  
  
  <meta name="keywords" content="quantum computing, julia, yao"/>
  
  
  <meta property="og:title" content="A Plot Recipe for Yao.jl">
  <meta property="og:type" content="note">
  <meta property="og:url" content="https://johnhearn.github.io//articles/plot-recipe-for-yao-jl/">
  <meta property="og:image" content="https://johnhearn.github.io/">
  <meta property="og:description" content="A distribution plot for Yao.jl">
  <meta property="og:site_name" content="John Hearn">
  
  <!-- Twitter cards -->
  <meta name="twitter:site"    content="@johnhearnbcn">
  <meta name="twitter:creator" content="@johnhearnbcn">
  <meta name="twitter:title"   content="A Plot Recipe for Yao.jl">

  
  <meta name="twitter:description" content="A distribution plot for Yao.jl">
  

  
  <!-- end of Twitter cards -->

  <!-- Google Fonts loaded here depending on setting in _data/options.yml true loads font, blank does not-->
  
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous">
  
  <!-- Load up MathJax script if needed ... specify in /_data/options.yml file-->
  
      <script type="text/x-mathjax-config"> 
        MathJax.Ajax.config.path["Contrib"]="https://cdn.mathjax.org/mathjax/contrib"; 
        MathJax.Hub.Register.StartupHook("TeX Jax Ready",function (){MathJax.Hub.Insert(MathJax.InputJax.TeX.Definitions.macros,{cancel: ["Extension","cancel"], bcancel: ["Extension","cancel"], xcancel: ["Extension","cancel"], cancelto: ["Extension","cancel"]});}); 
        MathJax.Hub.Config({tex2jax:{inlineMath: [['$','$'], ['\\(','\\)']], processEscapes: true}, TeX:{equationNumbers:{autoNumber: "AMS"}, extensions: ["[Contrib]/physics/physics.js","[Contrib]/siunitx/siunitx.js"]}});
      </script>
      <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  

  <link rel="stylesheet" type="text/css" href="/css/tufte.css">
  <!-- <link rel="stylesheet" type="text/css" href="/css/print.css" media="print"> -->

  <link rel="canonical" href="https://johnhearn.github.io//articles/plot-recipe-for-yao-jl">

  <link rel="alternate" type="application/rss+xml" title="John Hearn" href="https://johnhearn.github.io//feed.xml" />
</head>

  <body>
    <!--- Header and nav template site-wide -->
<header>
  <nav class="group">
	  <a href="/">BLOG</a>
	  <a href="/notes.html">NOTES</a>
	  <a href="/about">ABOUT</a>
	</nav>
</header>
    <article class="group">
      <h1>A Plot Recipe for Yao.jl</h1>
<div class="subtitle">July 26, 2020</div>
<div class="smaller">four minutes.</div>

<p>It’s sometimes useful to see a distribution plot for multiple results obtained from a quantum circuit. Take for example the random number generator from a <a href="quantum-random-numbers-in-yao-jl">previous post</a> where we used such a plot to check the results were uniformly distributed. Julia has great support for plotting. With the <a href="https://docs.juliaplots.org/latest/">Plots.jl</a> package it’s extremely easy to get a distribution histogram but getting the axes tidy is a bit fiddly. Fortunately Plots.jl provides a very conveniente extension mechanism which we can use.</p>

<p>As a reminder, here we generate an array of random 3-bit numbers using the <code class="language-plaintext highlighter-rouge">nshots</code> parameter to specify how many, in this case 1000.</p>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="n">Yao</span>
<span class="n">n</span><span class="o">=</span><span class="mi">3</span>
<span class="n">numbers</span> <span class="o">=</span> <span class="n">zero_state</span><span class="x">(</span><span class="n">n</span><span class="x">)</span> <span class="o">|&gt;</span> <span class="n">repeat</span><span class="x">(</span><span class="n">n</span><span class="x">,</span> <span class="n">H</span><span class="x">)</span> <span class="o">|&gt;</span> <span class="n">r</span> <span class="o">-&gt;</span> <span class="n">measure</span><span class="x">(</span><span class="n">r</span><span class="x">,</span> <span class="n">nshots</span><span class="o">=</span><span class="mi">10000</span><span class="x">)</span>
</code></pre></div></div>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">1000-element Array{BitBasis.BitStr{3,Int64},1}:
 100 ₍₂₎
       ⋮
 110 ₍₂₎
</span></code></pre></div></div>

<p>To see the histogram of results we could do something like this:</p>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">histogram</span><span class="x">(</span><span class="n">numbers</span> <span class="o">.|&gt;</span> <span class="n">bint</span><span class="x">,</span> <span class="n">legend</span><span class="o">=:</span><span class="n">none</span><span class="x">,</span> <span class="n">xticks</span><span class="o">=</span><span class="x">(</span><span class="mi">0</span><span class="o">:</span><span class="mi">7</span><span class="x">))</span>
</code></pre></div></div>

<p>This is OK but it has a few things I don’t like, for one the ticks don’t really line up properly with the bars. Also the ticks have to be manually set. Also the bins often have to be tweaked manually as well. These things are easy to fix and put inside a Plots.jl recipe for easy reuse.</p>

<p>Looking back at the results, Yao.jl gives us an array of <code class="language-plaintext highlighter-rouge">BitStr</code> results and the full type <code class="language-plaintext highlighter-rouge">Array{BitBasis.BitStr{3,Int64},1}</code> is parametrised by the number of bits. That turns out to be quite useful. Defining the recipe function like this:</p>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@recipe</span> <span class="k">function</span><span class="nf"> user_recipe</span><span class="x">(</span><span class="n">measurements</span><span class="o">::</span><span class="kt">Array</span><span class="x">{</span><span class="n">BitStr</span><span class="x">{</span><span class="n">n</span><span class="x">,</span><span class="kt">Int</span><span class="x">},</span><span class="mi">1</span><span class="x">})</span> <span class="k">where</span> <span class="n">n</span>
</code></pre></div></div>

<p>We now have access to the number of bits in $n$. The maximum possible value is then <code class="language-plaintext highlighter-rouge">max = (1&lt;&lt;n)-1</code>. Then we can calculate the histogram using standard Julia tools:</p>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">hist</span> <span class="o">=</span> <span class="n">fit</span><span class="x">(</span><span class="n">Histogram</span><span class="x">,</span> <span class="kt">Int</span><span class="o">.</span><span class="x">(</span><span class="n">measurements</span><span class="x">),</span> <span class="mi">0</span><span class="o">:</span><span class="n">max</span><span class="o">+</span><span class="mi">1</span><span class="x">)</span>
<span class="n">hist</span> <span class="o">=</span> <span class="n">normalize</span><span class="x">(</span><span class="n">hist</span><span class="x">,</span> <span class="n">mode</span><span class="o">=:</span><span class="n">pdf</span><span class="x">)</span>
</code></pre></div></div>

<p>Notice that this is where the conversion to <code class="language-plaintext highlighter-rouge">Int</code> happens and we one again use the <code class="language-plaintext highlighter-rouge">max</code> value that came via the type parametrisation. Next the plot attributes, basically the same as the histogram used above:</p>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">seriestype</span> <span class="o">:=</span> <span class="o">:</span><span class="n">bar</span>
<span class="n">bins</span> <span class="o">:=</span> <span class="n">max</span><span class="o">+</span><span class="mi">1</span>
<span class="n">xticks</span> <span class="o">--&gt;</span> <span class="x">(</span><span class="mi">0</span><span class="o">:</span><span class="n">max</span><span class="x">)</span>
<span class="n">legend</span> <span class="o">--&gt;</span> <span class="o">:</span><span class="n">none</span>
</code></pre></div></div>

<p>Again using the <code class="language-plaintext highlighter-rouge">max</code> value. Then we can return the histogram results, centering on the tick marks:</p>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">hist</span><span class="o">.</span><span class="n">edges</span><span class="x">[</span><span class="mi">1</span><span class="x">]</span> <span class="o">.-</span> <span class="mf">0.5</span><span class="x">,</span> <span class="n">hist</span><span class="o">.</span><span class="n">weights</span>
</code></pre></div></div>

<p>Y voila. Julia will automatically dispatch to our recipe based on the type of the results:</p>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot</span><span class="x">(</span><span class="n">results</span><span class="x">)</span>
</code></pre></div></div>

<p><img src="/assets/images/quantum-computing/random-dist-8.png" alt="Distribution of random numbers produced by the recipe" width="60%" /></p>

<p>To check with a different distriibution let’s try imitating a random 6-sided die by preselection of the unwanted values 6 and 7.</p>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="n">YaoBlocks</span><span class="o">.</span><span class="n">ConstGate</span><span class="o">.</span><span class="n">P0</span>

<span class="n">die</span> <span class="o">=</span> <span class="n">chain</span><span class="x">(</span><span class="mi">4</span><span class="x">,</span> 
    <span class="n">repeat</span><span class="x">(</span><span class="n">H</span><span class="x">,</span> <span class="mi">1</span><span class="o">:</span><span class="mi">3</span><span class="x">),</span>
    <span class="n">control</span><span class="x">((</span><span class="mi">2</span><span class="x">,</span><span class="mi">3</span><span class="x">),</span> <span class="mi">4</span><span class="o">=&gt;</span><span class="n">X</span><span class="x">),</span>
    <span class="n">put</span><span class="x">(</span><span class="mi">4</span><span class="o">=&gt;</span><span class="n">P0</span><span class="x">))</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">zero_state</span><span class="x">(</span><span class="mi">4</span><span class="x">)</span> <span class="o">|&gt;</span> <span class="n">block</span> <span class="o">|&gt;</span> <span class="n">r</span> <span class="o">-&gt;</span> <span class="n">focus!</span><span class="x">(</span><span class="n">r</span><span class="x">,</span> <span class="mi">1</span><span class="o">:</span><span class="mi">3</span><span class="x">)</span> <span class="o">|&gt;</span> <span class="n">r</span> <span class="o">-&gt;</span> <span class="n">measure</span><span class="x">(</span><span class="n">r</span><span class="x">,</span> <span class="n">nshots</span><span class="o">=</span><span class="mi">10000</span><span class="x">)</span>
<span class="n">plot</span><span class="x">(</span><span class="n">results</span><span class="x">)</span>
</code></pre></div></div>

<p><img src="/assets/images/quantum-computing/random-dist-6.png" alt="Distribution of preselected random numbers produced by the recipe" width="60%" /></p>

<p>Distribution shows values 6 and 7 have 0% probability, as we expected.</p>

<p>Working code available <a href="https://nbviewer.jupyter.org/github/johnhearn/notebooks/blob/master/QuantumComputing/A Plot Recipe for Yao.jl.ipynb">here</a>.</p>



<div id="share-bar">

    <div class="share-buttons">
        Share this:
        <a  href="https://twitter.com/intent/tweet?text=A Plot Recipe for Yao.jl&url=https://johnhearn.github.io//articles/plot-recipe-for-yao-jl"
            onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
            title="Share on Twitter" >
            <i class="fa-lg fab fa-twitter share-button"></i>
        </a>
        <a  href="https://www.linkedin.com/shareArticle?mini=true&url=https://johnhearn.github.io//articles/plot-recipe-for-yao-jl&title=A Plot Recipe for Yao.jl&summary=A distribution plot for Yao.jl&source=John Hearn"
            onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
            title="Share on LinkedIn" >
            <i class="fa-lg fab fa-linkedin share-button"></i>
        </a>
        <a  href="mailto:?subject=A Plot Recipe for Yao.jl&amp;body=Check out this site https://johnhearn.github.io//articles/plot-recipe-for-yao-jl"
            title="Share via Email" >
            <i class="fa-lg fa fa-envelope-open share-button"></i>
        </a>
    </div>

</div>

    </article>
    <span class="print-footer">A Plot Recipe for Yao.jl - July 26, 2020 - John Hearn</span>
    <footer>
  <hr class="slender">
  <ul class="footer-links">
    <li>
        <a href="https://twitter.com/johnhearnbcn">
        <span class="fa-stack fa-lg">
            <i class="fa fa-circle fa-stack-2x"></i>
            <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
        </span>
        </a>
    </li>
    <li>
        <a href="https://github.com/johnhearn">
        <span class="fa-stack fa-lg">
            <i class="fa fa-circle fa-stack-2x"></i>
            <i class="fab fa-github fa-stack-1x fa-inverse"></i>
        </span>
        </a>
    </li>
    <li>
        <a href="https://www.linkedin.com/in/john-hearn-599762b">
        <span class="fa-stack fa-lg">
            <i class="fa fa-circle fa-stack-2x"></i>
            <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
        </span>
        </a>
    </li>
    <li>
        <a href="mailto:hearn.john@gmail.com">
        <span class="fa-stack fa-lg">
            <i class="fa fa-circle fa-stack-2x"></i>
            <i class="fa fa-envelope-open fa-stack-1x fa-inverse"></i>
        </span>
        </a>
    </li>
</ul>

<div class="credits">
<span>&copy; 2025 &nbsp;&nbsp;JOHN HEARN</span></br> <br>
<span>This site created with the <a href="//github.com/clayh53/tufte-jekyll">Tufte theme</a> for <a href="//jekyllrb.com">Jekyll</a>.</span> 
</div>  
</footer>
  </body>
</html>
