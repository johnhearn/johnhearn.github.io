<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Stop Using @Autowire</title>

  
  <meta name="description" content="Some reasons why Spring&#39;s @Autowire annotation could be considered a code smell.">
  
  
  <meta name="keywords" content="spring framework, java"/>
  
  
  <meta property="og:title" content="Stop Using @Autowire">
  <meta property="og:type" content="note">
  <meta property="og:url" content="https://johnhearn.github.io//articles/stop-using-autowire/">
  <meta property="og:image" content="https://johnhearn.github.io//assets/images/springframework/icon.png">
  <meta property="og:description" content="Some reasons why Spring&#39;s @Autowire annotation could be considered a code smell.">
  <meta property="og:site_name" content="John Hearn">
  
  <!-- Twitter cards -->
  <meta name="twitter:site"    content="@johnhearnbcn">
  <meta name="twitter:creator" content="@johnhearnbcn">
  <meta name="twitter:title"   content="Stop Using @Autowire">

  
  <meta name="twitter:description" content="Some reasons why Spring's @Autowire annotation could be considered a code smell.">
  

  
  <meta name="twitter:card"  content="summary">
  
  <!-- end of Twitter cards -->

  <!-- Google Fonts loaded here depending on setting in _data/options.yml true loads font, blank does not-->
  
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous">
  
  <!-- Load up MathJax script if needed ... specify in /_data/options.yml file-->
  
      <script type="text/x-mathjax-config"> 
        MathJax.Ajax.config.path["Contrib"]="https://cdn.mathjax.org/mathjax/contrib"; 
        MathJax.Hub.Register.StartupHook("TeX Jax Ready",function (){MathJax.Hub.Insert(MathJax.InputJax.TeX.Definitions.macros,{cancel: ["Extension","cancel"], bcancel: ["Extension","cancel"], xcancel: ["Extension","cancel"], cancelto: ["Extension","cancel"]});}); 
        MathJax.Hub.Config({tex2jax:{inlineMath: [['$','$'], ['\\(','\\)']], processEscapes: true}, TeX:{equationNumbers:{autoNumber: "AMS"}, extensions: ["[Contrib]/physics/physics.js","[Contrib]/siunitx/siunitx.js"]}});
      </script>
      <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  

  <link rel="stylesheet" type="text/css" href="/css/tufte.css">
  <!-- <link rel="stylesheet" type="text/css" href="/css/print.css" media="print"> -->

  <link rel="canonical" href="https://johnhearn.github.io//articles/stop-using-autowire">

  <link rel="alternate" type="application/rss+xml" title="John Hearn" href="https://johnhearn.github.io//feed.xml" />
</head>

  <body>
    <!--- Header and nav template site-wide -->
<header>
  <nav class="group">
	  <a href="/">BLOG</a>
	  <a href="/notes.html">NOTES</a>
	  <a href="/about">ABOUT</a>
	</nav>
</header>
    <article class="group">
      <h1>Stop Using @Autowire</h1>
<div class="subtitle">April 3, 2020</div>
<div class="smaller">seven minutes.</div>

<p>The <a href="https://spring.io/">Spring Framework</a> is one of the most widely used Java frameworks around. There is a lot of great stuff in the Spring eco-system so it‚Äôs a shame to see its flagship feature, a dependency injection container, being widely misused.</p>

<p>First some history<label for="past" class="margin-toggle"> ‚äï</label><input type="checkbox" id="past" class="margin-toggle" /><span class="marginnote">Cheesy quote of the day: ‚Äû<em>You have to know the past to understand the present.</em>‚Äú ‚Äî  Carl Sagan </span>.</p>

<p>Spring has been around since the early-2000s and was conceived as an <a href="https://www.amazon.com/Expert-One-One-Design-Development/dp/0764543857">antidote</a> to the messy J2EE situation at the time. Its principal (but certainly not its only) attraction was a <strong>strong focus on Inversion of Control</strong> (IoC) and its dependency injection framework emerged amongst a plethora of competing DI containers.</p>

<p>In the beginning we had <em>bean descriptors</em> written in XML (best forgotten) and then<label for="2007" class="margin-toggle sidenote-number"></label><input type="checkbox" id="2007" class="margin-toggle" /><span class="sidenote">In 2007, apparently. </span>, when annotations became fashionable, and driven partly by competing frameworks like PicoContainer and Guice, (much of) the XML was replaced with <code class="language-plaintext highlighter-rouge">@Autowire</code>.</p>

<p>The strength of <code class="language-plaintext highlighter-rouge">@Autowire</code> (and, equally, <code class="language-plaintext highlighter-rouge">@Inject</code><label for="inject" class="margin-toggle sidenote-number"></label><input type="checkbox" id="inject" class="margin-toggle" /><span class="sidenote"><code class="language-plaintext highlighter-rouge">@Autowire</code> and the standardised <code class="language-plaintext highlighter-rouge">@Inject</code> annotations are essentially the same and Spring supports both. I‚Äôll consider them as synonyms in this post. </span>) is its simplicity: add the annotation and let the framework do the rest.</p>

<p>Even at that time there was a big debate about whether to use constructor or field injection, the former better by design and the latter simpler to apply, but in either case the annotation was required to be present somewhere in the class.</p>

<p>The rather unfortunate consequence of having to add Spring specific code to otherwise clean domain objects was considered a worthwhile trade-off. And since we‚Äôre using the annotation anyway why not just add it everywhere?</p>

<p><strong>The annotation is no longer required on constructors and the trade-off is no longer worthwhile</strong>. Nonetheless millions of developers are dragging it into the 2020s needlessly along with its disadvantages.</p>

<p>As an example consider this code:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">MyClass</span> <span class="o">{</span>
    <span class="nd">@Autowire</span> <span class="kd">private</span> <span class="nc">Foo</span> <span class="n">foo</span><span class="o">;</span>
    <span class="nd">@Autowire</span> <span class="kd">private</span> <span class="nc">Bar</span> <span class="n">bar</span><span class="o">;</span>

    <span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>

<p>This can be converted to the following code without having to do any other changes. Spring will handle it just fine.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">MyClass</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Foo</span> <span class="n">foo</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Bar</span> <span class="n">bar</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">MyClass</span><span class="o">(</span><span class="nc">Foo</span> <span class="n">foo</span><span class="o">,</span> <span class="nc">Bar</span> <span class="n">bar</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">foo</span> <span class="o">=</span> <span class="n">foo</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">bar</span> <span class="o">=</span> <span class="n">bar</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Granted that there are a couple of extra lines of boilerplate code<label for="lombok" class="margin-toggle sidenote-number"></label><input type="checkbox" id="lombok" class="margin-toggle" /><span class="sidenote">If this is important to you then consider using <a href="https://www.baeldung.com/spring-injection-lombok">Lombok to generate the appropriate constructor automatically</a>, but note that that has its own trade-offs. </span> but there are <a href="https://kinbiko.com/java/dependency-injection-patterns/">strong arguments</a> why the second option should be preferred and <code class="language-plaintext highlighter-rouge">@Autowire</code> <strong>should now be considered a code smell</strong>, especially on fields or accessors. This post outlines some of them.</p>

<p>There are also stylistic reasons<label for="othereasons" class="margin-toggle sidenote-number"></label><input type="checkbox" id="othereasons" class="margin-toggle" /><span class="sidenote">From maintainability issues to the IDE warnings about unassigned fields. </span> but I‚Äôll skip them here and concentrate on pure, cold engineering. Much of the same reasoning can be applied to the use of the <code class="language-plaintext highlighter-rouge">@Value</code> annotation as well. The objections can be grouped into two main categories.</p>

<p>Firstly, <strong>it makes it impossible to use the final modifier</strong>. Using the final modifier on fields is an important feature for multiple reasons:</p>

<p>Compilation fails if you have not provided all the necessary dependencies, whereas <code class="language-plaintext highlighter-rouge">@Autowire</code> fails at runtime. <strong>Compile time guarantees are stronger and safer than runtime testing</strong>, they just are. It‚Äôs easier and quicker to fix compilation errors than it is to find runtime bugs. So much magic makes configuration problems really hard to debug at runtime. <em>You will lose time over this</em>.</p>

<p>The simple fact that a value cannot change after construction gives <strong>additional assurances about the behaviour of the code</strong> just by looking at it. It explicitly declares intent and can help avoid some very hard to find bugs.</p>

<p>Final fields are <a href="https://www.javamex.com/tutorials/synchronization_final.shtml">guaranteed to be synchronised</a> between threads. If you don‚Äôt declare fields final, then you must cover thread-safety by some other means, or accept that you don‚Äôt have it.</p>

<p>The JVM adds extra care-taking to non-final fields to ensure <a href="https://dzone.com/articles/final-keyword-and-jvm-memory-impact">correct memory ordering</a> which is not needed in final fields. Additionally, <a href="https://bugs.openjdk.java.net/browse/JDK-8233873">there are plans</a> to allow the JIT compiler to aggressively optimise code in the knowledge that a field value will not change, as <a href="https://shipilev.net/jvm/anatomy-quarks/15-just-in-time-constants/">currently happens with static final fields</a>.</p>

<p>That should be enough by itself but there is another major group of objections, namely that it <strong>hides dependencies instead of making them explicit</strong>.</p>

<p>It‚Äôs so easy to add an <code class="language-plaintext highlighter-rouge">@Autowire</code> annotation to a field that the structure of the object graph almost inevitably becomes messy over time and, if not careful, can even lead to hard to maintain <a href="https://softwareengineering.stackexchange.com/a/12030">circular dependencies</a>.</p>

<p>A long list of dependencies in a constructor is a signal that a class has too many responsibilities (violating the <a href="https://en.wikipedia.org/wiki/Single-responsibility_principle">SRP</a>) but it‚Äôs easy for the same number of annotations to go unnoticed inside a class with many fields.</p>

<p><code class="language-plaintext highlighter-rouge">@Autowired</code> classes are needlessly harder to test. Either we have to bootstrap the entire framework (see below), make our fields public or use something like Mockito‚Äôs <code class="language-plaintext highlighter-rouge">@InjectMocks</code>, a good example of engineering a solution to a problem that can been avoided altogether.</p>

<p>It‚Äôs a NullPointerException <a href="http://olivergierke.de/2013/11/why-field-injection-is-evil/">waiting to happen</a>. If you construct an instance outside of Spring then the fields must be public or otherwise initialised using setters, breaking encapsulation. It also means it‚Äôs possible to create an object in an invalid state breaking the ‚Äúmake invalid state unrepresentable‚Äù advice.</p>

<p>Finally, it unnecessarily ties your code to the Spring framework binaries making migrations between frameworks<label for="migrations" class="margin-toggle sidenote-number"></label><input type="checkbox" id="migrations" class="margin-toggle" /><span class="sidenote">Unfortunately I‚Äôve had to do several over the years: EBJ -&gt; Spring, Spring -&gt; EJB, Spring Boot 1.x -&gt; Spring Boot 2.x üò† </span> and restructuring of the domain much harder. This also applies to <code class="language-plaintext highlighter-rouge">@Service</code>, <code class="language-plaintext highlighter-rouge">@Component</code>, etc. which can also be removed but that‚Äôs another story.</p>

<p>Having said all that, as always there are some notable exceptions to the general rule.</p>

<p>Autowiring with <code class="language-plaintext highlighter-rouge">@Bean</code> annotations can (and probably should) be used in Spring configuration classes, which you are likely already using if you‚Äôre using Spring. In this case <code class="language-plaintext highlighter-rouge">@Autowire</code> is still mostly unnecessary and again you can keep Spring stuff out of your domain. For example:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Configuration</span>
<span class="kd">static</span> <span class="kd">class</span> <span class="nc">SomeConfiguration</span> <span class="o">{</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">MyClass</span> <span class="nf">myClass</span><span class="o">(</span><span class="nc">Foo</span> <span class="n">foo</span><span class="o">,</span> <span class="nc">Bar</span> <span class="n">bar</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">MyClass</span><span class="o">(</span><span class="n">foo</span><span class="o">,</span> <span class="n">bar</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>This may be useful if you want to perform some additional configuration and avoids the <code class="language-plaintext highlighter-rouge">@PostConstruct</code> nonsense. Again, the idea is to keep all the Spring based annotations inside the configurations and outside the domain classes. This way your domain classes will be clean and typically easier to test without the heavy machinery of‚Ä¶</p>

<p><code class="language-plaintext highlighter-rouge">@SpringBootTest</code> <a href="https://www.baeldung.com/spring-boot-testing">automagically</a> uses <code class="language-plaintext highlighter-rouge">@Autowire</code> to inject fully configured objects into your tests. A suitable constructor would be better but JUnit<label for="junit" class="margin-toggle sidenote-number"></label><input type="checkbox" id="junit" class="margin-toggle" /><span class="sidenote">Another ubiquitous annotation magic wielding library </span> has its limitations. Take for example:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RunWith</span><span class="o">(</span><span class="nc">SpringJUnit4ClassRunner</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="nd">@ActiveProfiles</span><span class="o">(</span><span class="s">"test"</span><span class="o">)</span>
<span class="nd">@SpringBootTest</span><span class="o">(</span><span class="n">classes</span> <span class="o">=</span> <span class="nc">ApplicationConfig</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">BigOldServiceTestIT</span> <span class="o">{</span>

  <span class="nd">@Autowired</span> <span class="kd">private</span> <span class="nc">BigOldService</span> <span class="n">service</span><span class="o">;</span>

  <span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>

<p>There are probably more exceptions, there always are. I‚Äôll add them as I think of them. On the other had there are definitely more reasons not to, we haven even talked about anaemic domains and good OO design here. That‚Äôll be for another post.</p>


<div id="share-bar">

    <div class="share-buttons">
        Share this:
        <a  href="https://twitter.com/intent/tweet?text=Stop Using @Autowire&url=https://johnhearn.github.io//articles/stop-using-autowire"
            onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
            title="Share on Twitter" >
            <i class="fa-lg fab fa-twitter share-button"></i>
        </a>
        <a  href="https://www.linkedin.com/shareArticle?mini=true&url=https://johnhearn.github.io//articles/stop-using-autowire&title=Stop Using @Autowire&summary=Some reasons why Spring's @Autowire annotation could be considered a code smell.&source=John Hearn"
            onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
            title="Share on LinkedIn" >
            <i class="fa-lg fab fa-linkedin share-button"></i>
        </a>
        <a  href="mailto:?subject=Stop Using @Autowire&amp;body=Check out this site https://johnhearn.github.io//articles/stop-using-autowire"
            title="Share via Email" >
            <i class="fa-lg fa fa-envelope-open share-button"></i>
        </a>
    </div>

</div>

    </article>
    <span class="print-footer">Stop Using @Autowire - April 3, 2020 - John Hearn</span>
    <footer>
  <hr class="slender">
  <ul class="footer-links">
    <li>
        <a href="https://twitter.com/johnhearnbcn">
        <span class="fa-stack fa-lg">
            <i class="fa fa-circle fa-stack-2x"></i>
            <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
        </span>
        </a>
    </li>
    <li>
        <a href="https://github.com/johnhearn">
        <span class="fa-stack fa-lg">
            <i class="fa fa-circle fa-stack-2x"></i>
            <i class="fab fa-github fa-stack-1x fa-inverse"></i>
        </span>
        </a>
    </li>
    <li>
        <a href="https://www.linkedin.com/in/john-hearn-599762b">
        <span class="fa-stack fa-lg">
            <i class="fa fa-circle fa-stack-2x"></i>
            <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
        </span>
        </a>
    </li>
    <li>
        <a href="mailto:hearn.john@gmail.com">
        <span class="fa-stack fa-lg">
            <i class="fa fa-circle fa-stack-2x"></i>
            <i class="fa fa-envelope-open fa-stack-1x fa-inverse"></i>
        </span>
        </a>
    </li>
</ul>

<div class="credits">
<span>&copy; 2025 &nbsp;&nbsp;JOHN HEARN</span></br> <br>
<span>This site created with the <a href="//github.com/clayh53/tufte-jekyll">Tufte theme</a> for <a href="//jekyllrb.com">Jekyll</a>.</span> 
</div>  
</footer>
  </body>
</html>
